function carouselInit(){document.querySelectorAll('[data-carousel]').forEach(carousel=>{const track=carousel.querySelector('.c-carousel__track');const items=Array.from(track.children);const prevBtn=carousel.querySelector('[data-prev]');const nextBtn=carousel.querySelector('[data-next]');const dotsWrapper=carousel.querySelector('[data-dots]');let index=0;let startX=0;let deltaX=0;let isDragging=false;let startTranslate=0;const getItemsPerView=()=>parseInt(getComputedStyle(carousel).getPropertyValue('--items'),10);const getGap=()=>{const cs=getComputedStyle(carousel);return parseFloat(cs.getPropertyValue('--items-gap'))||0;};const getItemWidth=()=>items[0]?.offsetWidth||0;const getMaxIndex=()=>{const itemsPerView=getItemsPerView();return Math.max(0,items.length-itemsPerView);};const getMaxTranslate=()=>{const itemWidth=getItemWidth();const gap=getGap();return(itemWidth+gap)*getMaxIndex();};const getTranslateForIndex=(i)=>{const itemWidth=getItemWidth();const gap=getGap();return-((itemWidth+gap)*i);};const clamp=(v,min,max)=>Math.max(min,Math.min(v,max));const isStatic=()=>items.length<=getItemsPerView();const updateArrowsDisabled=()=>{if(!prevBtn||!nextBtn)return;if(isStatic()){prevBtn.disabled=true;nextBtn.disabled=true;return;}prevBtn.disabled=index===0;nextBtn.disabled=index===getMaxIndex();};const updateControlsVisibility=()=>{const hide=isStatic();if(prevBtn)prevBtn.style.display=hide?'none':'';if(nextBtn)nextBtn.style.display=hide?'none':'';if(dotsWrapper)dotsWrapper.style.display=hide?'none':'';};const buildDots=()=>{if(!dotsWrapper)return;if(isStatic()){dotsWrapper.innerHTML='';return;}dotsWrapper.innerHTML='';const itemsPerView=getItemsPerView();const dotsCount=Math.ceil(items.length/itemsPerView);for(let p=0;p<dotsCount;p++){const dot=document.createElement('button');dot.className='c-carousel__dot';dot.type='button';dot.addEventListener('click',()=>{const targetIndex=p*itemsPerView;index=clamp(targetIndex,0,getMaxIndex());update();});dotsWrapper.appendChild(dot);}setActiveDot();};const setActiveDot=()=>{if(!dotsWrapper||isStatic())return;const dots=Array.from(dotsWrapper.querySelectorAll('.c-carousel__dot'));if(!dots.length)return;const maxIndex=getMaxIndex();let activeDot=0;if(maxIndex>0){activeDot=Math.round((index/maxIndex)*(dots.length-1));}dots.forEach((dot,i)=>dot.classList.toggle('is-active',i===activeDot));};const update=(animate=true)=>{if(isStatic()){track.style.transition='none';track.style.transform='translateX(0px)';updateArrowsDisabled();return;}index=clamp(index,0,getMaxIndex());track.style.transition=animate?'transform 0.4s ease':'none';track.style.transform=`translateX(${getTranslateForIndex(index)}px)`;setActiveDot();updateArrowsDisabled();};nextBtn?.addEventListener('click',()=>{if(isStatic())return;const itemsPerView=getItemsPerView();const nextIndex=(Math.floor(index/itemsPerView)+1)*itemsPerView;index=clamp(nextIndex,0,getMaxIndex());update();});prevBtn?.addEventListener('click',()=>{if(isStatic())return;const itemsPerView=getItemsPerView();const prevIndex=(Math.floor(index/itemsPerView)-1)*itemsPerView;index=clamp(prevIndex,0,getMaxIndex());update();});track.addEventListener('pointerdown',e=>{if(isStatic())return;e.preventDefault();isDragging=true;startX=e.clientX;deltaX=0;startTranslate=getTranslateForIndex(index);track.setPointerCapture(e.pointerId);track.style.cursor='grabbing';update(false);});track.addEventListener('pointermove',e=>{if(!isDragging)return;deltaX=e.clientX-startX;const maxTranslate=getMaxTranslate();let nextTranslate=startTranslate+deltaX;nextTranslate=clamp(nextTranslate,-maxTranslate,0);track.style.transform=`translateX(${nextTranslate}px)`;});track.addEventListener('pointerup',e=>{if(!isDragging)return;const itemsPerView=getItemsPerView();const itemWidth=getItemWidth();const threshold=itemWidth*0.25;if(deltaX>threshold){const prevIndex=(Math.floor(index/itemsPerView)-1)*itemsPerView;index=clamp(prevIndex,0,getMaxIndex());}else if(deltaX<-threshold){const nextIndex=(Math.floor(index/itemsPerView)+1)*itemsPerView;index=clamp(nextIndex,0,getMaxIndex());}isDragging=false;deltaX=0;track.releasePointerCapture(e.pointerId);track.style.cursor='grab';update(true);});track.addEventListener('pointerleave',()=>{if(!isDragging)return;isDragging=false;deltaX=0;update(true);});window.addEventListener('resize',()=>{updateControlsVisibility();buildDots();update(false);});track.style.cursor='grab';updateControlsVisibility();buildDots();update(false);updateArrowsDisabled();});}document.addEventListener('DOMContentLoaded',carouselInit);function tabsInit(){const tabsBlocks=document.querySelectorAll(".js-tabs");tabsBlocks.forEach(tabsBlock=>{const tabsLinks=tabsBlock.querySelectorAll(".js-tabs-link");const contents=tabsBlock.querySelectorAll(".js-tabs-content");const pics=tabsBlock.querySelectorAll(".js-tabs-pic");let currentPic=tabsBlock.querySelector(".js-tabs-pic.is-active");tabsLinks.forEach((link,index)=>{link.dataset.tab=index;});contents.forEach((content,index)=>{content.dataset.tab=index;});pics.forEach((pic,index)=>{pic.dataset.tab=index;});function setContentsHeight(){let maxHeight=0;contents.forEach(content=>{content.style.minHeight="auto";});contents.forEach(content=>{const height=content.offsetHeight;if(height>maxHeight){maxHeight=height;}});contents.forEach(content=>{content.style.minHeight=`${maxHeight}px`;});}setContentsHeight();let resizeTimer;window.addEventListener("resize",()=>{clearTimeout(resizeTimer);resizeTimer=setTimeout(setContentsHeight,150);});tabsLinks.forEach(link=>{link.addEventListener("click",event=>{event.preventDefault();const tabIndex=link.dataset.tab;tabsLinks.forEach(link=>link.classList.remove("is-active"));link.classList.add("is-active");contents.forEach(content=>content.classList.remove("is-active"));const activeContent=tabsBlock.querySelector(`.js-tabs-content[data-tab="${tabIndex}"]`);if(activeContent){activeContent.classList.add("is-active");}const activePic=tabsBlock.querySelector(`.js-tabs-pic[data-tab="${tabIndex}"]`);if(!activePic||activePic===currentPic)return;pics.forEach(pic=>pic.classList.remove("is-active"));activePic.classList.add("is-visible");activePic.classList.add("is-active");const prevPic=currentPic;currentPic=activePic;activePic.addEventListener("animationend",()=>{if(prevPic&&prevPic!==activePic){prevPic.classList.remove("is-visible");}},{once:true});});});});}document.addEventListener('DOMContentLoaded',tabsInit);function faqsInit(){document.querySelectorAll('.js-faqs > li').forEach(item=>{const question=item.children[0];const answer=item.children[1];if(!question||!answer)return;if(item.classList.contains('is-open')){answer.style.maxHeight=answer.scrollHeight+'px';}question.addEventListener('click',()=>{const isOpen=item.classList.contains('is-open');if(isOpen){answer.style.maxHeight=null;item.classList.remove('is-open');}else{answer.style.maxHeight=answer.scrollHeight+'px';item.classList.add('is-open');}});});}window.addEventListener('load',faqsInit);function dialcodeInit(){document.addEventListener("DOMContentLoaded",()=>{const $phoneInputs=document.querySelectorAll('.js-phone-input');if($phoneInputs.length>0){$phoneInputs.forEach(phoneInput=>{const $dialcode=phoneInput.querySelector(".js-dialcode");const $input=phoneInput.querySelector(".js-form__input");const $prefixEl=phoneInput.querySelector(".js-phone-prefix");const $hiddenInput=phoneInput.querySelector(".js-phone-value");if($dialcode){const $dialcodeShow=$dialcode.querySelector(".js-showDialcode");const $dialcodeFlag=$dialcodeShow.querySelector(".c-dialcode__flag");const $dialcodeOptions=$dialcode.querySelectorAll('.js-dialcodeOption');let currentPrefix=$prefixEl.textContent;if($dialcodeShow){$dialcodeShow.addEventListener("click",(e)=>{e.stopPropagation();document.querySelectorAll('.js-dialcode.is-open').forEach(openDialcode=>{if(openDialcode!==$dialcode){openDialcode.classList.remove('is-open');}});$dialcode.classList.toggle("is-open");});}if($dialcodeOptions.length>0){$dialcodeOptions.forEach(option=>{option.addEventListener('click',function(){const prefix=this.getAttribute('data-prefix');currentPrefix=prefix;$prefixEl.textContent=prefix;const optionImg=this.querySelector("img");if(optionImg&&$dialcodeFlag){$dialcodeFlag.src=optionImg.src;$dialcodeFlag.alt=optionImg.alt;}$dialcodeOptions.forEach(opt=>opt.hidden=false);this.hidden=true;setTimeout(()=>{$dialcode.classList.remove("is-open");},200);});});}$input.addEventListener("input",()=>{const cleanNumber=$input.value.replace(/\D/g,'');$hiddenInput.value=`${currentPrefix}${cleanNumber}`;});document.addEventListener("click",(e)=>{if(!$dialcode.contains(e.target)){$dialcode.classList.remove("is-open");}});}});}});}dialcodeInit();function addOddItemsClass(){const lists=document.querySelectorAll('.js-calculate-items');lists.forEach(list=>{const items=list.querySelectorAll('li');if(items.length%2!==0){list.classList.add('has-odd-items');}});}addOddItemsClass();document.addEventListener("DOMContentLoaded",function(){const form=document.querySelector(".c-registration-form .c-form");if(!form)return;const nameInput=form.querySelector("#name");const emailInput=form.querySelector("#email");const phoneInput=form.querySelector("#phone-num");const phoneHiddenInput=form.querySelector('input[name="phone-num-final"]');const contactMethodInput=form.querySelector("#primary-contact-method");const contactMethodHiddenInput=form.querySelector('input[name="primary-contact-method-final"]');const messageInput=form.querySelector('textarea[name="mensaje"]');const submitBtn=form.querySelector('button[type="submit"]');if(!nameInput||!emailInput||!submitBtn)return;let isSubmitting=false;let successMessage=form.querySelector(".c-form__success-message");let errorMessage=form.querySelector(".c-form__error-message");if(!successMessage){successMessage=document.createElement("div");successMessage.className="c-form__success-message";successMessage.style.display="none";successMessage.style.padding="15px";successMessage.style.marginTop="20px";successMessage.style.backgroundColor="#d4edda";successMessage.style.color="#155724";successMessage.style.border="1px solid #c3e6cb";successMessage.style.borderRadius="4px";successMessage.textContent="¡Gracias! Tu solicitud ha sido enviada exitosamente. Te contactaremos pronto.";form.appendChild(successMessage);}if(!errorMessage){errorMessage=document.createElement("div");errorMessage.className="c-form__error-message";errorMessage.style.display="none";errorMessage.style.padding="15px";errorMessage.style.marginTop="20px";errorMessage.style.backgroundColor="#f8d7da";errorMessage.style.color="#721c24";errorMessage.style.border="1px solid #f5c6cb";errorMessage.style.borderRadius="4px";form.appendChild(errorMessage);}function validateEmail(value){const trimmed=value.trim();if(!trimmed)return false;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(trimmed);}function showSuccess(){if(successMessage){successMessage.style.display="block";}if(errorMessage){errorMessage.style.display="none";}nameInput.value="";emailInput.value="";if(phoneInput)phoneInput.value="";if(phoneHiddenInput)phoneHiddenInput.value="";if(contactMethodInput)contactMethodInput.value="";if(contactMethodHiddenInput)contactMethodHiddenInput.value="";if(messageInput)messageInput.value="";successMessage.scrollIntoView({behavior:"smooth",block:"center"});setTimeout(()=>{if(successMessage){successMessage.style.display="none";}},8000);}function showError(message){if(errorMessage){errorMessage.textContent=message;errorMessage.style.display="block";}if(successMessage){successMessage.style.display="none";}errorMessage.scrollIntoView({behavior:"smooth",block:"center"});}function getEmailTemplate(){return `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>¡Gracias por Registrarte!</title></head><body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;"><table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="background-color: #f4f4f4; padding: 20px 0;"><tr><td align="center"><table role="presentation" width="600" cellspacing="0" cellpadding="0" border="0" style="background-color: #ffffff; border-radius: 8px;"><tr><td align="center" style="background: linear-gradient(135deg, #0022ff 0%, #0033cc 100%); padding: 40px 20px; border-radius: 8px 8px 0 0;"><h1 style="margin: 0; color: #ffffff; font-size: 28px; font-weight: bold;">¡Bienvenido al Programa de Afiliados!</h1></td></tr><tr><td style="padding: 35px 30px;"><h2 style="color: #0022ff; font-size: 22px; margin: 0 0 20px 0;">Gracias por Registrarte,{{name}}</h2><p style="color: #333333; font-size: 16px; line-height: 1.6; margin: 0 0 20px 0;">Tu solicitud al<strong>Programa de Afiliados de Betamina</strong>ha sido recibida exitosamente. Nuestro equipo la revisará y te contactaremos pronto.</p><div style="background-color: #f8f9ff; border-left: 4px solid #0022ff; border-radius: 4px; padding: 20px; margin: 25px 0;"><h3 style="color: #0022ff; font-size: 16px; margin: 0 0 12px 0;">Datos Registrados</h3><p style="color: #333333; font-size: 14px; margin: 5px 0;"><strong>Nombre:</strong>{{name}}</p><p style="color: #333333; font-size: 14px; margin: 5px 0;"><strong>Email:</strong>{{email}}</p><p style="color: #333333; font-size: 14px; margin: 5px 0;"><strong>Teléfono:</strong>{{phone}}</p></div><div style="margin: 25px 0;"><h3 style="color: #0022ff; font-size: 18px; margin: 0 0 15px 0;">Próximos Pasos</h3><ol style="margin: 0; padding-left: 20px; color: #333333; font-size: 14px; line-height: 1.8;"><li style="margin-bottom: 10px;">Revisaremos tu solicitud en 24-48 horas</li><li style="margin-bottom: 10px;">Te contactaremos para conocer tu estrategia</li><li>Recibirás acceso al panel de NetRefer</li></ol></div></td></tr><tr><td style="padding: 25px; background-color: #f8f9ff; text-align: center;"><p style="margin: 0; color: #999999; font-size: 12px;">© 2026 Betamina-Programa de Afiliados</p></td></tr></table></td></tr></table></body></html>`;}async function submitForm(data){const url="https://l5j6mnkgyvi3pvrcqzhenb5fc40rwipi.lambda-url.us-east-1.on.aws/";const htmlTemplate=getEmailTemplate();const payload={from:"Betamina",to:["juan.larrosa@solcre.com"],subject:"¡Bienvenido al Programa de Afiliados de Betamina!",html_body:htmlTemplate,variables:{name:data.name,email:data.email,phone:data.phone||"No proporcionado",contact_method:data.contact_method||"Email",message:data.message||""}};const response=await fetch(url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",},body:JSON.stringify(payload),});if(!response.ok){let errorDetails="";try{const errorData=await response.json();errorDetails=errorData.message||errorData.error||"Error del servidor";}catch(e){const errorText=await response.text();errorDetails=errorText||"Error desconocido";}throw new Error(`Error ${response.status}: ${errorDetails}`);}return response.json();}async function handleSubmit(event){event.preventDefault();if(isSubmitting)return;const name=nameInput.value.trim();const email=emailInput.value.trim();if(!name){nameInput.focus();showError("Por favor, ingresá tu nombre completo");return;}if(!validateEmail(email)){emailInput.focus();showError("Por favor, ingresá un email válido");return;}const phone=phoneHiddenInput?phoneHiddenInput.value:(phoneInput?phoneInput.value:"");const contactMethod=contactMethodHiddenInput?contactMethodHiddenInput.value:(contactMethodInput?contactMethodInput.value:"");const message=messageInput?messageInput.value.trim():"";const formData={name,email,phone,contact_method:contactMethod||"Email",message};try{isSubmitting=true;submitBtn.textContent="Enviando...";submitBtn.disabled=true;await submitForm(formData);showSuccess();}catch(error){console.error(error);showError("Error al enviar el formulario. Por favor, intentalo de nuevo más tarde.");}finally{isSubmitting=false;submitBtn.textContent="Enviar Solicitud";submitBtn.disabled=false;}}form.addEventListener("submit",handleSubmit);[nameInput,emailInput].forEach((input)=>{if(input){input.addEventListener("input",()=>{if(errorMessage&&errorMessage.style.display!=="none"){errorMessage.style.display="none";}});}});});